<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>1FMOVIE</title>
    <meta name="robots" content="index, follow">
    <meta name="revisit-after" content="1 days">
    <meta property="og:type" content="website">
    <meta property="og:title" content="1FMOVIE">
    <meta property="og:description" content="1FMOVIE - A tight-knit group of teens unearths a long-buried secret, setting off a chain of illicit events that takes them on an adventure they'll never forget.">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="canonical" href="https://1fmovie.com/details.html">
    <link href="http://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" integrity="sha512-xA6Hp6oezhjd6LiLZynuukm80f8BoZ3OpcEYaqKoCV3HKQDrYjDE1Gu8ocxgxoXmwmSzM4iqPvCsOkQNiu41GA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" type="text/css" href="css/all.min.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <link href="css/video-js.css" rel="stylesheet">
    <link href="css/player-custom.css" rel="stylesheet">
    <link href="css/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/all.css">
    <link rel="stylesheet" href="css/all_1.css">
    <link rel="stylesheet" href="css/search-dropdown.css">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">
    <!-- AdBlueMedia Content Locker CSS -->
    <link rel="stylesheet" href="content-locker/adbluemedia-locker.css">
   
<style>
        .video-js .vjs-big-play-button {
            line-height: 2.5em;
            height: 2.8em;
            width: 2.8em;
            border: .10em solid #00acc1;
            background-color: #1c242c;
            background-color: rgba(49, 84, 120, 0.7);
            border-radius: 50%;
        }
        .vjs-big-play-centered .vjs-big-play-button {
            margin-top: -1.4em;
            margin-left: -1.4em;
        }
        .vjs-icon-play:before, .video-js .vjs-play-control .vjs-icon-placeholder:before, .video-js .vjs-big-play-button .vjs-icon-placeholder:before {
            color: #00acc1;
        }
    </style>
    <style>
        .video-js .vjs-picture-in-picture-control {
            display: none;
        }
    </style>
    <style>
        /* Mobile touch improvements */
        .video-js video {
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        .video-js .vjs-big-play-button {
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            z-index: 2;
        }
        
        .video-js .vjs-control-bar {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        .video-js .vjs-control {
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
    </style>
    <style>
        a,
        section.bl .heading .title,
        section.bl .heading h1,
        section.bl .heading h2,
        section.bl .heading h3,
        #slider .item .info .actions .watchnow,
        .btn-outline-info,
        .filmlist .item:hover .title,
        .vjs-icon-play:before,
        .video-js .vjs-play-control .vjs-icon-placeholder:before,
        .video-js .vjs-big-play-button .vjs-icon-placeholder:before,
        header #menu>li>a:hover,
        header #menu>li>ul>li>a:hover,
        .page-link:hover,
        #episodes .bl-servers .heading,
        #episodes .bl-seasons .heading {
            color: #00acc1
        }
        a:hover{
            opacity: .7;
            color: #00acc1
        }
        .filmlist .item .poster:before {
            background-color: #00acc1;
            background-image: -webkit-gradient(linear,left top,left bottom,from(#00acc1),to(#00acc1));
            background-image: -webkit-linear-gradient(top,#00acc1,#00acc1);
        }
        #slider .paging>span.active,
        #slider .paging>span.swiper-pagination-bullet-active,
        #slider .item .info .actions .watchnow:hover,
        .btn-outline-info:hover,
        .btn-outline-info:not(:disabled):not(.disabled).active,
        .btn-outline-info:not(:disabled):not(.disabled):active,
        .show>.btn-outline-info.dropdown-toggle,
        #slider .item .info .meta .quality,
        .watch-extra section.info .info .meta .quality,
        section.bl .heading .tabs>span.active,
        .filmlist .item .icons>div.quality,
        #episodes .bl-seasons ul li.active,
        #episodes .bl-servers ul.episodes li a.active {
            background-color: #00acc1
        }
        section.bl .heading .tabs>span.active {
            color: #000000
        }
        #slider .item .info .actions .watchnow,
        .btn-outline-info:hover,
        .btn-outline-info:not(:disabled):not(.disabled).active,
        .show>.btn-outline-info.dropdown-toggle,
        .btn-outline-info,
        .video-js .vjs-big-play-button,
        .page-link,
        #episodes .bl-seasons ul li.active,
        #episodes .bl-servers ul.episodes li a.active {
            border-color: #00acc1
        }
        .btn-outline-info.focus,
        .btn-outline-info:not(:disabled):not(.disabled).active:focus,
        .btn-outline-info:not(:disabled):not(.disabled):active:focus,
        .show>.btn-outline-info.dropdown-toggle:focus,
        .btn-outline-info:focus {
            box-shadow: 0 0 0 0.2rem #00acc1;
        }
        .proof>* {
            background-color: #00acc1
        }
        .proof .proof-data {
            color: #000000
        }
    </style>
    <style>
        /* Fix background image display - use cover but ensure proper positioning */
        #watch .play {
            background-size: cover !important;
            background-position: center center !important;
        }
        
        /* Reduce overlay darkness to show more of the image */
        #watch .play:before {
            opacity: 0.6 !important;
        }
    </style>
   
</head>
<body oncontextmenu="return false">
    <header class="abs-head">
        <div class="container">
            <div class="wrapper justify-content-between align-items-center">
                <div class="start"> 
                    <div id="menu">
                    </div>
                        <a class="logo" href="https://1fmovie.com"><img src="images/logo.png" alt="1FMOVIE"> </a> 
                    </div> 
                    <div class="step"> 
                        <div class="search-box">
                            <button class="search-toggler"><i class="bi bi-search"></i></button>
                            <div class="search-wrap">
                                <form class="d-flex align-items-center" action="" autocomplete="off">
                                    <a class="filter-btn btn btn-sm" href="#"><i class="bi bi-funnel"></i> Filter</a> 
                                        <input type="text" placeholder="Search movies..." name="keyword" id="search-input"> 
                                    <button type="submit"><i class="bi bi-search"></i></button>
                                </form> 
                                <div class="search-suggestions" id="search-suggestions">
                                    <!-- Search results will be loaded here -->
                                </div>
                            <div class="suggestions"></div>
                            </div>
                        </div>
                    </div>
                    <div class="end"> 
                    <div id="user"></div> 
                </div>
            </div> 
        </div> 
    </header>
        <div id="body">
        <div id="watch">         
        <div class="play" >
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-12 col-md-8">
                    <div style="height:6em"></div>
                        <div id="player" style="height: 100%">
                            <div class="BgA">    
                                <video id="my-video" class="video-js vjs-16-9 vjs-big-play-centered" controls="" width="600" height="315" poster="" data-setup="" webkit-playsinline="true" playsinline="true">
                                    <p>Your browser does not support the video tag.</p>
                                </video>
                            </div>
                        </div>
                </div>
            </div>
        </div>
        </div>
        <div class="container py-4">
            <div class="row">
                    <div class="col d-flex justify-content-center">
                        <a onclick="showAdBlueLocker()" class="btn btn-outline-info mx-1">Watch Now <i class="fa fa-film" aria-hidden="false"></i></a>
                        <a onclick="showAdBlueLocker()" class="btn btn-outline-info mx-1">Download <i class="fa fa-download" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <main>
            <div class="watch" itemprop="mainEntity" itemscope="" itemtype="https://schema.org/Movie">
                <div class="container watch-page">
                    <div class="aside-wrapper info-ep">
                        <aside class="main">
                        <section id="w-info" style="opacity: 0; transition: opacity 0.3s ease-in-out;">
                            <div class="poster"> <img itemprop="image" src="" alt="" style="opacity: 0; transition: opacity 0.3s ease-in-out;"> </div>
                            <div class="info">
                                <h1 itemprop="name" class="name"></h1>
                                <div class="meta">
                                    <span class="quality"></span>
                                    <span class="rating"></span>
                                    <span><i class="fa fa-star" style="color: yellow;"></i></span>
                                    <span class="year"></span>
                                    <span></span>
                                </div>
                                <div class="description cts-wrapper"></div>
                                <div class="detail" style="font-weight: 300; margin-bottom: 1rem;">
                                    <div>
                                        <div>Type:</div>
                                        <span>TV Show</span>
                                    </div>
                                    <div>
                                        <div>Genre:</div>
                                        <span>
                                            <span> Action & Adventure, Drama, Mystery </span>
                                            
                                        </span>
                                    </div>
                                    <div>
                                        <div>Release:</div>
                                        <span itemprop="dateCreated">  </span>
                                    </div>
                                    <div>
                                        <div>Cast:</div>
                                        <span>
                                            <span> Lee Jung-jae, Wi Ha-jun, Park Hae-soo</span>
                                        </span>
                                    </div>
                                    
                                </div>
                            </div>
                        </section>
                        </aside>
                        <script>
                            // Replace sidebar content based on 'type' URL parameter
                            document.addEventListener('DOMContentLoaded', function () {
                                function getUrlParameter(name) {
                                    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
                                    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
                                    var results = regex.exec(location.search);
                                    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
                                }

                                // Function to escape HTML
                                function escapeHtml(text) {
                                    const map = {
                                        '&': '&amp;',
                                        '<': '&lt;',
                                        '>': '&gt;',
                                        '"': '&quot;',
                                        "'": '&#039;'
                                    };
                                    return text ? text.replace(/[&<>"']/g, function(m) { return map[m]; }) : '';
                                }

                                // Function to shuffle array
                                function shuffleArray(array) {
                                    const shuffled = [...array];
                                    for (let i = shuffled.length - 1; i > 0; i--) {
                                        const j = Math.floor(Math.random() * (i + 1));
                                        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                                    }
                                    return shuffled;
                                }

                                var type = getUrlParameter('type');
                                var currentId = getUrlParameter('id');
                                var sidebar = document.querySelector('.aside-wrapper .sidebar');
                                
                                if (sidebar && type === 'movie') {
                                    // Fetch config.json to load random movies
                                    fetch('config.json')
                                        .then(response => response.json())
                                        .then(config => {
                                            const movies = config.Movies || [];
                                            
                                            // Filter out current movie
                                            const filteredMovies = movies.filter(movie => movie.id != currentId);
                                            
                                            // Shuffle the movies and take up to 5
                                            const shuffledMovies = shuffleArray(filteredMovies);
                                            const recommendedMovies = shuffledMovies.slice(0, Math.min(5, shuffledMovies.length));
                                            
                                            // Generate HTML for recommended movies
                                            const moviesHtml = recommendedMovies.map(movie => {
                                                return `
                                                    <a class="item" href="details.html?id=${movie.id}&type=movie">
                                                        <div class="poster">
                                                            <div>
                                                                <img class="lazyloaded" data-src="${escapeHtml(movie.poster)}" alt="${escapeHtml(movie.title)}" src="${escapeHtml(movie.poster)}">
                                                            </div>
                                                        </div>
                                                        <div class="info">
                                                            <div>
                                                                <span>Movie</span>
                                                                <span>${escapeHtml(movie.releaseDate)}</span>
                                                                <span>${escapeHtml(movie.duration)}</span>
                                                            </div>
                                                            <div class="name">${escapeHtml(movie.title)}</div>
                                                        </div>
                                                    </a>
                                                `;
                                            }).join('');

                                            sidebar.innerHTML = `
                                                <section class="mb-5">
                                                    <div class="head">
                                                        <div class="start">
                                                            <h2 class="title"><i class="bi bi-file-play-fill"></i>RECOMMENDED</h2>
                                                        </div>
                                                    </div>
                                                    <div class="body" style="font-size: 1.0rem;">
                                                        <div class="scaff top9 items">
                                                            ${moviesHtml}
                                                        </div>
                                                    </div>
                                                </section>
                                            `;

                                            console.log(`Loaded ${recommendedMovies.length} recommended movies (excluding current movie ID: ${currentId})`);
                                        })
                                        .catch(error => {
                                            console.error('Error loading recommended movies:', error);
                                            // Fallback to empty recommendations
                                            sidebar.innerHTML = `
                                                <section class="mb-5">
                                                    <div class="head">
                                                        <div class="start">
                                                            <h2 class="title"><i class="bi bi-file-play-fill"></i>RECOMMENDED</h2>
                                                        </div>
                                                    </div>
                                                    <div class="body" style="font-size: 1.0rem;">
                                                        <div class="scaff top9 items">
                                                            <p>No recommendations available</p>
                                                        </div>
                                                    </div>
                                                </section>
                                            `;
                                        });
                                }
                            });
                        </script>
                        <aside class="sidebar">
                             <section id="episodes" class="tv">
                                <div class="head">
                                    <div class="dropdown">
                                        <button class="btn dropdown-toggle" data-toggle="dropdown" data-placeholder="false">
                                            <span class="season-view">Season 3</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <a class="dropdown-item season-item" href="javascript:;" data-season="1"> Season 3 </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="body">
                                    <ul class="episodes" style="display: block" data-season="1">
                                         
                                    </ul>
                                </div>
                            </section>
                        </aside>
                    </div>
                </div>
            </div>
        </main>
        <div class="clearfix"></div>
        </div>
        
       
       <footer> 
                <div class="container" style="display: flex; justify-content: center; align-items: center; flex-direction: column; text-align: center;">
                    <div class="head" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
                        <div class="start"></div>
                        <div class="end" style="display: flex; flex-direction: column; align-items: center;">
                            <div class="logo" style="margin-bottom: 16px;">
                                <a href="https://1fmovie.com" title="1FMOVIE">
                                    <img src="images/logo.png" alt="1FMOVIE">
                                </a>
                            
                            </div>
                            <div class="abs" style="max-width: 600px;">
                                <div>
                                    1FMOVIE is top of free streaming website, where to watch movies online free without registration required. With a big database and great features, we're confident 1FMOVIE is the best free movies online website in the space that you can't simply miss!
                                </div>
                                <div class="bottom-text" style="margin-top: 12px;">
                                    This site does not store any files on our server, we only linked to the media which is hosted on 3rd party services.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer> 
        

    </div>
    
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/swiper.min.js"></script>
    <script type="text/javascript" src="js/lazysizes.min.js"></script>    
    <script src="js/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    
    <script>
        // Global variable to store the current series data
        let currentSeries = null;
        // Global variable to store the Video.js player instance
        let myPlayer = null;

        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Function to escape HTML
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text ? text.replace(/[&<>"']/g, function(m) { return map[m]; }) : '';
        }

        // Function to load video with HLS support (Video.js)
        function loadVideoSource(src, poster = '') {
            if (!myPlayer || !src) return;
            
            // Set poster if provided
            if (poster) {
                myPlayer.poster(poster);
            }
            
            // Load video source
            myPlayer.src({
                type: src.includes('.m3u8') ? 'application/x-mpegURL' : 'video/mp4',
                src: src
            });
            
            myPlayer.load();
        }

        // Function to load a specific episode
        function loadEpisode(episodeNumber) {
            if (!currentSeries) {
                console.error('Series data not loaded');
                return;
            }

            const episodeIndex = episodeNumber - 1;
            if (currentSeries.seasonEpisodesVids && currentSeries.seasonEpisodesVids[episodeIndex]) {
                const episodeSrc = currentSeries.seasonEpisodesVids[episodeIndex];
                
                // Reset player
                if (myPlayer) {
                    myPlayer.currentTime(0);
                    loadVideoSource(episodeSrc, currentSeries.thumbnail);
                }

                // Update episode links
                const episodeLinks = document.querySelectorAll('.episodes li a');
                episodeLinks.forEach(link => {
                    link.classList.remove('active');
                    if (parseInt(link.getAttribute('data-episode')) === episodeNumber) {
                        link.classList.add('active');
                    }
                });

                console.log(`Loading episode ${episodeNumber}: ${episodeSrc}`);
            } else {
                console.log(`Episode ${episodeNumber} not found`);
            }
        }

        // Function to load series information
        function loadSeriesInfo() {
            const seriesId = getUrlParameter('id');
            const type = getUrlParameter('type');
            
            if (!seriesId) {
                console.log('No series ID found in URL parameters');
                return;
            }

            // Fetch config.json
            fetch('config.json')
                .then(response => response.json())
                .then(data => {
                    let item = null;
                    
                    // Find item based on type
                    if (type === 'movie') {
                        item = data.Movies.find(movie => movie.id == seriesId);
                        if (!item) {
                            console.log('Movie not found');
                            return;
                        } else {
                            console.log('Movie found:', item.title, 'ID:', item.id);
                        }
                    } else if (type === 'tv') {
                        item = data.Series.find(series => series.id == seriesId);
                        if (!item) {
                            console.log('Series not found');
                            return;
                        } else {
                            console.log('Series found:', item.title, 'ID:', item.id);
                        }
                    }
                    
                    if (item) {
                        currentSeries = item; // Store globally

                        // Initialize AdBuildMedia locker dynamically using global LockerData
                        if (data.LockerData && data.LockerData.LockerIt && data.LockerData.LockerKey && data.LockerData.Lockervar && data.LockerData.LockerSrcUrl) {
                            console.log('Initializing AdBuildMedia locker with config:', data.LockerData);
                            
                            // Create and inject the locker variable script using custom variable name
                            const varScript = document.createElement('script');
                            varScript.type = 'text/javascript';
                            varScript.textContent = `var ${data.LockerData.Lockervar} = { "it": ${data.LockerData.LockerIt}, "key": "${data.LockerData.LockerKey}" };`;
                            document.head.appendChild(varScript);
                            console.log('Locker variable script injected:', data.LockerData.Lockervar);

                            // Create and inject the locker main script using custom source URL
                            const lockerScript = document.createElement('script');
                            lockerScript.src = data.LockerData.LockerSrcUrl;
                            lockerScript.async = true;
                            
                            // Add load event listener to track when script loads
                            lockerScript.addEventListener('load', function() {
                                console.log('AdBuildMedia locker script loaded successfully');
                                console.log('_bu function available:', typeof window._bu === 'function');
                                console.log('Locker variable available:', typeof window[data.LockerData.Lockervar] !== 'undefined');
                            });
                            
                            lockerScript.addEventListener('error', function() {
                                console.error('Failed to load AdBuildMedia locker script from:', data.LockerData.LockerSrcUrl);
                            });
                            
                            document.head.appendChild(lockerScript);

                            console.log('AdBuildMedia locker configured dynamically from global config:', {
                                it: data.LockerData.LockerIt,
                                key: data.LockerData.LockerKey,
                                variable: data.LockerData.Lockervar,
                                srcUrl: data.LockerData.LockerSrcUrl,
                                duration: data.LockerData.LockerDurationinSeconds
                            });

                            // Store global locker data in currentSeries for later use
                            currentSeries.LockerData = data.LockerData;
                            
                            // Add a delayed check to verify locker is ready
                            setTimeout(() => {
                                console.log('Delayed locker check:');
                                console.log('- _bu function:', typeof window._bu === 'function');
                                console.log('- Locker variable:', typeof window[data.LockerData.Lockervar] !== 'undefined');
                                console.log('- Variable value:', window[data.LockerData.Lockervar]);
                            }, 3000);
                            
                        } else {
                            console.log('Global LockerData or its properties missing from config:', {
                                LockerData: data.LockerData
                            });
                        }

                        // Update poster with preloading
                        const posterImg = document.querySelector('#w-info .poster img');
                        if (posterImg) {
                            if (item.poster) {
                                // Preload the image
                                const img = new Image();
                                img.onload = function() {
                                    // Image loaded successfully - update src and show
                                    posterImg.src = item.poster;
                                    posterImg.alt = escapeHtml(item.title);
                                    posterImg.style.opacity = '1';
                                };
                                img.onerror = function() {
                                    // Image failed to load - keep it hidden
                                    console.warn('Poster image failed to load:', item.poster);
                                    posterImg.style.opacity = '0';
                                    posterImg.alt = escapeHtml(item.title);
                                };
                                img.src = item.poster;
                            } else {
                                posterImg.alt = escapeHtml(item.title);
                                posterImg.style.opacity = '0';
                            }
                        }

                        // Update title
                        const titleElement = document.querySelector('#w-info .name');
                        if (titleElement) {
                            titleElement.textContent = item.title || titleElement.textContent;
                        }

                        // Update meta information
                        const qualityElement = document.querySelector('#w-info .meta .quality');
                        if (qualityElement) {
                            qualityElement.textContent = item.quality || qualityElement.textContent;
                        }

                        const ratingElement = document.querySelector('#w-info .meta .rating');
                        if (ratingElement) {
                            ratingElement.textContent = item.rating || ratingElement.textContent;
                        }

                        const yearElement = document.querySelector('#w-info .meta .year');
                        if (yearElement) {
                            yearElement.textContent = item.releaseDate || yearElement.textContent;
                        }

                        const durationElement = document.querySelector('#w-info .meta span:last-child');
                        if (durationElement) {
                            durationElement.textContent = item.duration || durationElement.textContent;
                        }

                        // Update description
                        const descriptionElement = document.querySelector('#w-info .description');
                        if (descriptionElement) {
                            descriptionElement.textContent = item.description || descriptionElement.textContent;
                        }

                        // Update type in detail section
                        const typeElement = document.querySelector('#w-info .detail div:nth-child(1) span');
                        if (typeElement) {
                            typeElement.textContent = type === 'movie' ? 'Movie' : 'TV Show';
                        }

                        // Update genre
                        const genreElement = document.querySelector('#w-info .detail div:nth-child(2) span span');
                        if (genreElement) {
                            genreElement.textContent = item.genre || genreElement.textContent;
                        }

                        // Update release date
                        const releaseDateElement = document.querySelector('#w-info .detail div:nth-child(3) span');
                        if (releaseDateElement) {
                            releaseDateElement.textContent = item.releaseDate || releaseDateElement.textContent;
                        }

                        // Update cast
                        const castElement = document.querySelector('#w-info .detail div:nth-child(4) span span');
                        if (castElement) {
                            castElement.textContent = item.cast || castElement.textContent;
                        }

                        // Update page title
                        document.title = item.title || document.title;

                        // Update meta tags dynamically
                        const metaTitle = document.querySelector('meta[property="og:title"]');
                        const metaDescription = document.querySelector('meta[property="og:description"]');
                        const metaCanonical = document.querySelector('link[rel="canonical"]');

                        if (metaTitle) {
                            metaTitle.content = item.title || metaTitle.content;
                        }

                        if (metaDescription) {
                            metaDescription.content = item.description || metaDescription.content;
                        }

                        if (metaCanonical) {
                            metaCanonical.href = `https://1fmovie.com/details.html?id=${item.id}&type=${type}`;
                        }

                        console.log('Meta tags updated dynamically:', {
                            title: metaTitle?.content,
                            description: metaDescription?.content,
                            canonical: metaCanonical?.href
                        });

                        // Update background image - resize if using original size
                        const playElement = document.querySelector('.play');
                        if (playElement && item.thumbnail) {
                            // Replace /t/p/original with /t/p/w1280 for better performance and display
                            let thumbnailUrl = item.thumbnail;
                            if (thumbnailUrl.includes('/t/p/original')) {
                                thumbnailUrl = thumbnailUrl.replace('/t/p/original', '/t/p/w1280');
                            }
                            playElement.style.backgroundImage = `url(${thumbnailUrl})`;
                            // Ensure background displays properly with cover
                            playElement.style.setProperty('background-size', 'cover', 'important');
                            playElement.style.setProperty('background-position', 'center center', 'important');
                        }

                        // Handle different content types
                        if (type === 'movie') {
                            // For movies, hide episode-related sections and load video directly
                            const seasonSection = document.querySelector('.season-section');
                            if (seasonSection) {
                                seasonSection.style.display = 'none';
                            }
                            
                            const episodesSection = document.querySelector('.episodes');
                            if (episodesSection) {
                                episodesSection.style.display = 'none';
                            }
                            
                            // Load movie video directly
                            if (myPlayer && item.vidLink) {
                                loadVideoSource(item.vidLink, item.thumbnail);
                            }
                            
                        } else if (type === 'tv') {
                            // For TV shows, handle seasons and episodes
                            
                            // Update season information
                            const seasonViewElement = document.querySelector('.season-view');
                            if (seasonViewElement && item.season) {
                                // Format season text properly (e.g., "season 3" -> "Season 3")
                                const formattedSeason = item.season.replace(/\b\w/g, l => l.toUpperCase());
                                seasonViewElement.textContent = formattedSeason;
                            }

                            // Update season dropdown
                            const seasonItemElement = document.querySelector('.season-item');
                            if (seasonItemElement && item.season) {
                                // Format season text properly for dropdown item
                                const formattedSeason = item.season.replace(/\b\w/g, l => l.toUpperCase());
                                seasonItemElement.textContent = formattedSeason;
                                
                                // Extract season number from the season string
                                const seasonNumber = item.season.match(/\d+/);
                                if (seasonNumber) {
                                    seasonItemElement.setAttribute('data-season', seasonNumber[0]);
                                }
                            }

                            // Update episodes list based on seasonEpisodesVids array
                            const episodesList = document.querySelector('.episodes');
                            if (episodesList && item.seasonEpisodesVids && Array.isArray(item.seasonEpisodesVids)) {
                                episodesList.innerHTML = '';
                                
                                // Extract season number for data attribute
                                const seasonNumber = item.season ? item.season.match(/\d+/) : null;
                                const seasonNum = seasonNumber ? seasonNumber[0] : '1';
                                
                                // Set data-season attribute on episodes list
                                episodesList.setAttribute('data-season', seasonNum);
                                
                                // Generate episodes based on the array length
                                item.seasonEpisodesVids.forEach((episode, index) => {
                                    const episodeNum = index + 1;
                                    const isFirstEpisode = index === 0;
                                    const li = document.createElement('li');
                                    li.innerHTML = `
                                        <a href="javascript:void(0);" data-toggle="tooltip" data-episode="${episodeNum}" class="${isFirstEpisode ? 'active' : ''}">
                                            <span class="num">Episode ${episodeNum}</span>
                                        </a>
                                    `;
                                    episodesList.appendChild(li);
                                });
                                
                                // Attach click event to each episode link
                                episodesList.querySelectorAll('a').forEach((link, index) => {
                                    const episodeNum = index + 1;
                                    link.addEventListener('click', function() {
                                        loadEpisode(episodeNum);
                                    });
                                });
                                
                                console.log(`Generated ${item.seasonEpisodesVids.length} episodes for ${item.season}`);
                            }

                            // If the video is available, set the first episode
                            if (myPlayer && item.seasonEpisodesVids && item.seasonEpisodesVids.length > 0) {
                                loadVideoSource(item.seasonEpisodesVids[0], item.thumbnail);
                            }
                        }

                        // Show content after all updates are done
                        const wInfoSection = document.querySelector('#w-info');
                        if (wInfoSection) {
                            wInfoSection.style.opacity = '1';
                        }

                        console.log('Content information loaded successfully:', item.title);
                    } else {
                        console.log('Content not found with ID:', seriesId);
                        // Show content even if not found (might be 404 case)
                        const wInfoSection = document.querySelector('#w-info');
                        if (wInfoSection) {
                            wInfoSection.style.opacity = '1';
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading config.json:', error);
                    // Show content even on error
                    const wInfoSection = document.querySelector('#w-info');
                    if (wInfoSection) {
                        wInfoSection.style.opacity = '1';
                    }
                });
        }

        // Initialize the player when the DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Check if required URL parameters exist
            const seriesId = getUrlParameter('id');
            const type = getUrlParameter('type');
            
            if (!seriesId || !type) {
                console.log('Missing required URL parameters (id or type), redirecting to 404');
                window.location.href = '404.html';
                return;
            }
            
            // Validate ID exists in the appropriate array based on type
            fetch('config.json')
                .then(response => response.json())
                .then(config => {
                    let itemExists = false;
                    
                    if (type === 'movie') {
                        // Check if the ID exists in Movies array
                        itemExists = config.Movies && config.Movies.some(movie => movie.id == seriesId);
                    } else if (type === 'tv') {
                        // Check if the ID exists in Series array
                        itemExists = config.Series && config.Series.some(series => series.id == seriesId);
                    }
                    
                    if (!itemExists) {
                        console.log(`Item with ID ${seriesId} not found in ${type} collection, redirecting to 404`);
                        window.location.href = '404.html';
                        return;
                    }
                    
                    // Load series information first
                    loadSeriesInfo();
                })
                .catch(error => {
                    console.error('Error loading config.json:', error);
                    window.location.href = '404.html';
                    return;
                });

            // Initialize Video.js player (exact same as fake-player)
            myPlayer = videojs("my-video", {
                fluid: !0,
                ControlBar: {
                    DurationDisplay: !0
                }
            });
            
            // Get locker duration from config or use default
            var pausetime = 30;
            
            // Load locker duration from config if available
            fetch('config.json')
                .then(response => response.json())
                .then(config => {
                    if (config.LockerData && config.LockerData.LockerDurationinSeconds) {
                        pausetime = parseInt(config.LockerData.LockerDurationinSeconds);
                    }
                })
                .catch(err => console.error('Error loading config:', err));
            
            // Video.js timeupdate event for AdBlueMedia locker
            myPlayer.on('timeupdate', function(e) {
                if (myPlayer.currentTime() >= pausetime) {
                    myPlayer.pause();
                    if (typeof showAdBlueLocker === 'function') {
                        showAdBlueLocker();
                    }
                    if (myPlayer.isFullscreen()) {
                        myPlayer.exitFullscreen();
                    }
                }
            });
            
            myPlayer.paused();
            
            // Mobile touch support - tap video to play/pause
            myPlayer.ready(function() {
                var videoElement = myPlayer.el().querySelector('video');
                if (videoElement) {
                    var touchStartTime = 0;
                    var touchStartX = 0;
                    var touchStartY = 0;
                    
                    // Touch start
                    videoElement.addEventListener('touchstart', function(e) {
                        touchStartTime = new Date().getTime();
                        touchStartX = e.touches[0].clientX;
                        touchStartY = e.touches[0].clientY;
                    }, { passive: true });
                    
                    // Touch end - handle tap to play/pause
                    videoElement.addEventListener('touchend', function(e) {
                        var touchEndTime = new Date().getTime();
                        var touchEndX = e.changedTouches[0].clientX;
                        var touchEndY = e.changedTouches[0].clientY;
                        
                        var touchDuration = touchEndTime - touchStartTime;
                        var touchDistance = Math.sqrt(
                            Math.pow(touchEndX - touchStartX, 2) + 
                            Math.pow(touchEndY - touchStartY, 2)
                        );
                        
                        // Only handle if it's a quick tap (not a swipe) and not on controls
                        if (touchDuration < 300 && touchDistance < 20) {
                            var target = e.target || (e.changedTouches && e.changedTouches[0] && e.changedTouches[0].target);
                            
                            // Check if clicked on controls - use helper function
                            function isOnControl(element) {
                                if (!element) return false;
                                
                                // Check if element itself is a control
                                if (element.classList && (
                                    element.classList.contains('vjs-control-bar') ||
                                    element.classList.contains('vjs-big-play-button') ||
                                    element.classList.contains('vjs-play-control') ||
                                    element.classList.contains('vjs-control')
                                )) {
                                    return true;
                                }
                                
                                // Check parent elements
                                var parent = element.parentElement;
                                var depth = 0;
                                while (parent && depth < 5) {
                                    if (parent.classList && (
                                        parent.classList.contains('vjs-control-bar') ||
                                        parent.classList.contains('vjs-big-play-button') ||
                                        parent.classList.contains('vjs-play-control')
                                    )) {
                                        return true;
                                    }
                                    parent = parent.parentElement;
                                    depth++;
                                }
                                
                                return false;
                            }
                            
                            // Only toggle if not clicking on controls
                            if (!isOnControl(target)) {
                                e.preventDefault();
                                e.stopPropagation();
                                
                                // Toggle play/pause
                                setTimeout(function() {
                                    if (myPlayer.paused()) {
                                        myPlayer.play();
                                    } else {
                                        myPlayer.pause();
                                    }
                                }, 50);
                            }
                        }
                    }, { passive: false });
                }
            });
            
            // Handle episode clicks
            if ($(".ep-item").length) {
                $(".ep-item").on('click', function() {
                    myPlayer.currentTime(0);
                    myPlayer.play();
                });
            }
        });
    </script>
    
    <!-- Search Toggle Functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchToggler = document.querySelector('.search-toggler');
            const searchWrap = document.querySelector('.search-wrap');
            const searchInput = document.getElementById('search-input');
            const searchSuggestions = document.getElementById('search-suggestions');
            let allItems = [];
            let searchTimeout;
            
            // Load all items from config
            fetch('config.json')
                .then(res => res.json())
                .then(config => {
                    const { Movies = [], Series = [] } = config;
                    allItems = [...Movies, ...Series];
                })
                .catch(err => console.error('Error loading config:', err));
            
            if (searchToggler && searchWrap) {
                searchToggler.addEventListener('click', function() {
                    searchWrap.classList.toggle('toggled');
                    
                    // Focus on the search input when opened
                    if (searchWrap.classList.contains('toggled')) {
                        setTimeout(() => {
                            searchInput.focus();
                        }, 100);
                    } else {
                        // Hide suggestions when closing search
                        searchSuggestions.classList.remove('show');
                    }
                });
                
                // Search functionality
                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const query = this.value.trim();
                        
                        // Clear previous timeout
                        if (searchTimeout) {
                            clearTimeout(searchTimeout);
                        }
                        
                        if (query.length < 2) {
                            searchSuggestions.classList.remove('show');
                            return;
                        }
                        
                        // Show loading
                        searchSuggestions.innerHTML = '<div class="loading">Searching...</div>';
                        searchSuggestions.classList.add('show');
                        
                        // Debounce search
                        searchTimeout = setTimeout(() => {
                            performSearch(query);
                        }, 300);
                    });
                    
                    // Show dropdown when search is opened
                    searchInput.addEventListener('focus', function() {
                        if (this.value.trim().length >= 2) {
                            searchSuggestions.classList.add('show');
                        }
                    });
                    
                    // Handle keyboard navigation
                    searchInput.addEventListener('keydown', function(e) {
                        if (e.key === 'Escape') {
                            searchWrap.classList.remove('toggled');
                            searchSuggestions.classList.remove('show');
                        }
                    });
                }
                
                // Close search when clicking outside
                document.addEventListener('click', function(e) {
                    if (!searchWrap.contains(e.target) && !searchToggler.contains(e.target)) {
                        searchWrap.classList.remove('toggled');
                        searchSuggestions.classList.remove('show');
                    }
                });
                
                // Close search when pressing Escape key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && searchWrap.classList.contains('toggled')) {
                        searchWrap.classList.remove('toggled');
                        searchSuggestions.classList.remove('show');
                    }
                });
            }
            
            // Search function
            function performSearch(query) {
                const results = allItems.filter(item => {
                    const title = item.title.toLowerCase();
                    const searchQuery = query.toLowerCase();
                    return title.includes(searchQuery);
                }).slice(0, 10); // Limit to 10 results
                
                if (results.length === 0) {
                    searchSuggestions.innerHTML = '<div class="no-results">No results found</div>';
                } else {
                    searchSuggestions.innerHTML = results.map(item => {
                        const type = item.seasonEpisodesVids && item.seasonEpisodesVids.length > 0 ? 'Tv' : 'Movie';
                        const year = item.releaseDate ? new Date(item.releaseDate).getFullYear() : '';
                        const rating = item.rating ? parseFloat(item.rating).toFixed(3) : '0.000';
                        const duration = item.duration ? `${item.duration} min` : '';
                        
                        return `
                            <div class="search-item" onclick="window.location.href='${getItemLink(item)}'">
                                <img src="${item.thumbnail}" alt="${item.title}" class="thumbnail" loading="lazy">
                                <div class="content">
                                    <div class="title">${item.title}</div>
                                    <div class="meta">
                                        <span class="type">${type}</span>
                                        <span class="year">${year}</span>
                                        <span class="rating"> ${rating}</span>
                                        <span class="duration">${duration}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }
            
            // Helper function to get correct link for item
            function getItemLink(item) {
                if (item.seasonEpisodesVids && item.seasonEpisodesVids.length > 0) {
                    return `details.html?id=${item.id}&type=tv`;
                }
                return `details.html?id=${item.id}&type=movie`;
            }
        });
    </script>
    
    <!-- AdBlueMedia Content Locker Configuration (load before locker script) -->
    <script src="content-locker/adblue-config.js"></script>
    <!-- AdBlueMedia Content Locker JavaScript -->
    <script src="content-locker/adbluemedia-locker.js"></script>
</body>
</html>